
<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Yoga Studio Template">
    <meta name="keywords" content="Yoga, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>FINER THREADS</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900&display=swap"
        rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="/css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="/css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
           .applyCoupon {
            visibility: visible;
        }

        .removeCoupon {
            visibility: hidden;
        }

    </style>
    
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>
    
    <!-- Search model -->
	<div class="search-model">
		<div class="h-100 d-flex align-items-center justify-content-center">
			<div class="search-close-switch">+</div>
			<form class="search-model-form">
				<input type="text" id="search-input" placeholder="Search here.....">
			</form>
		</div>
	</div>
	<!-- Search model end -->

    <!-- Header Section Begin -->
    <header class="header-section">
        <div class="container-fluid">
            <div class="inner-header">
                <div class="logo">
                    <a href="/"><img src="/img/logo.png" alt=""></a>
                </div>
            </div>
        </div>
    </header>




     <!-- main -->
     <div id="wrapper-site">
        <div class="container">
            <div class="row">
                <div id="content-wrapper" class="col-xs-12 col-sm-12 col-md-12 col-lg-12 onecol">
                    <div id="main">
                        <div class="cart-grid row">
                            <div class="container mt-5">
                                <h2 class="mb-4">Shipping Details</h2>
                                <hr>
                                <div style="display: flex;">
                                    <div class="mb-4">
                                        <h4>Shipping Address:</h4><%= address.firstname %>,<br> <%= address.housename %>, <%= address.city %>, <%= address.state %>, <%= address.pincode %><br><%= address.country %></p>
                                    </div>
                                    <div style="margin-left: 30%;">

                                        <div class="input-group">
                                            <input type="text" placeholder="Enter coupon code" class="form-control"
                                                name="coupon" id="couponCode">
                                            <button onclick="checkCoupon()" class="btn btn-secondary applyCoupon"
                                                id="applyCoupons">Apply</button>
                                                <button onclick="removeCoupon()"
                                                    class="btn btn-secondary removeCoupon"
                                                    id="removeCoupons">Remove</button>
                                                    
                                        </div>
                                        <br>
                                                    <h6 style="color: red; margin-left: 20px;" id="couponmsg"></h6>
                                        <br>
                                        <!-- <div class="input-group">
                                            <span class="input-group-text">Wallet Amount</span>

                                            <input type="text" aria-label="First name" class="form-control"
                                                name="coupon" id="Wallet" value="{{userData.[0].wallet}}"
                                                disabled>
                                                <p id="wallethidden" hidden>{{userData.[0].wallet}}</p>
                                            <button onclick="applyWallet()" class="btn btn-warning applyWallet"
                                                id="applyWallet">use</button>
                                            <button onclick="removeWallet()"
                                                class="btn btn-warning removeWallet"
                                                id="removeWallet">Remove</button>
                                        </div> -->

                                    </div>
                                </div>

                                <h4>Product Details</h4>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Product Name</th>
                                            <th scope="col">Quantity</th>
                                            <th scope="col">Price</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% catData.forEach(function(item) { %>
                                            <tr>
                                                <td><%= item.product %></td>
                                                <td><%= item.quentity %></td>
                                                <td>₹ <%= item.offerPrice %></td>
                                            </tr>
                                        <% }); %>
                                    
                                        <!-- {{!-- <tr>
                                            <td></td>
                                            <td><strong>Total Price</strong></td>
                                            <td> <strong>
                                                    <p id="totalAmount">{{totalPrice}}</p>
                                                </strong>
                                            </td>
                                        </tr> --}} -->

                                    </tbody>
                                </table>
                                <hr>
                                <div style="padding-left: 60%;">
                                    <span id="price" hidden><%= totalPrice %></span>
                                    <h6 style="padding-left: 45%;" >₹ <%= totalPrice %></h6>
                                    <h5 id="applied" style="display: none;">Coupon Applied</h5>
                                    
                                    <h6 style="margin-top: -7%;padding-left: 8%;display: none;" id="discountValue"></h6>
                                    <br>
                                    <!-- <h5 id="appliedWallet" style="display: none;">Wallet Applied</h5> -->
                                    <h6 style="margin-top: -6%;padding-left: 8%;display: none;" id="walletValue"></h6>
                                    <hr>
                                    <h5>Price</h5>
                                    <h6 style="margin-top: 3%; padding-left: 41%;">₹</h6><h6 style="margin-top: -6%;padding-left: 45%;" id="totalAmount"><%= totalPrice %></h6>

                                </div>
                                

                                <div class="mt-3">
                                    <!-- Payment buttons -->
                                    <p id="cartotal" hidden><%= userin %></p>
                                    <div class="mt-3">
                                        <a href="/paymentSuccess" class="btn btn-primary">COD Payment</a>
                                        <!-- <button class="btn btn-primary razaropay" onclick="">Online Payment</button> -->
                                    </div>


                                </div>
                                <!-- <div class="popup" id="popup">
                                    <h3>Coupon Code</h3>
                                    <p id="couponmsg"></p>
                                    <button type="button" onclick="popupClose()">OK</button>

                                </div> -->

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>




        <!-- Footer Section Begin -->
        <footer class="footer-section spad">
            <div class="container">
                <div class="footer-widget">
                    <div class="row">
                        <div class="col-lg-3 col-sm-6">
                            <div class="single-footer-widget">
                                <h4>About us</h4>
                                <ul>
                                    <li>About Us</li>
                                    <li>Community</li>
                                    <li>Jobs</li>
                                    <li>Shipping</li>
                                    <li>Contact Us</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-6">
                            <div class="single-footer-widget">
                                <h4>Customer Care</h4>
                                <ul>
                                    <li>Search</li>
                                    <li>Privacy Policy</li>
                                    <li>2019 Lookbook</li>
                                    <li>Shipping & Delivery</li>
                                    <li>Gallery</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-6">
                            <div class="single-footer-widget">
                                <h4>Our Services</h4>
                                <ul>
                                    <li>Free Shipping</li>
                                    <li>Free Returnes</li>
                                    <li>Our Franchising</li>
                                    <li>Terms and conditions</li>
                                    <li>Privacy Policy</li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-6">
                            <div class="single-footer-widget">
                                <h4>Information</h4>
                                <ul>
                                    <li>Payment methods</li>
                                    <li>Times and shipping costs</li>
                                    <li>Product Returns</li>
                                    <li>Shipping methods</li>
                                    <li>Conformity of the products</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="social-links-warp">
                <div class="container">
                    <div class="social-links">
                        <a href="" class="instagram"><i class="fa fa-instagram"></i><span>instagram</span></a>
                        <a href="" class="pinterest"><i class="fa fa-pinterest"></i><span>pinterest</span></a>
                        <a href="" class="facebook"><i class="fa fa-facebook"></i><span>facebook</span></a>
                        <a href="" class="twitter"><i class="fa fa-twitter"></i><span>twitter</span></a>
                        <a href="" class="youtube"><i class="fa fa-youtube"></i><span>youtube</span></a>
                        <a href="" class="tumblr"><i class="fa fa-tumblr-square"></i><span>tumblr</span></a>
                    </div>
                </div>
    
    <div class="container text-center pt-5">
                    <p>Copyright &copy;<script>document.write(new Date().getFullYear());</script> Finer Therads</p>
                </div>
    
    
            </div>
        </footer>
        <!-- Footer Section End -->
    
        <!-- Js Plugins -->
        <script src="/js/jquery-3.3.1.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/jquery.magnific-popup.min.js"></script>
        <script src="/js/jquery.slicknav.js"></script>
        <script src="/js/owl.carousel.min.js"></script>
        <script src="/js/jquery.nice-select.min.js"></script>
        <script src="/js/mixitup.min.js"></script>
        <script src="/js/main.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js"></script>

    <script>


function checkCoupon(event) {

//const coupon = $('#couponCode').val();
const coupon = document.getElementById('couponCode').value
const amount = document.getElementById('price').innerText
console.log(amount)
console.log(coupon)

// Make the AJAX request
$.ajax({
    url: '/couponCheck',
    type: 'POST',
    data: {
        coupon: coupon,
        amount: amount
    },
    dataType: 'json',
    success: function (res) {
        if (res.success) {
            console.log(res)
            const applied = document.getElementById('applied')
            console.log(applied)
            const appliedamount = document.getElementById('discountValue')
            applied.style.display = 'inline'
            appliedamount.style.display = 'inline'
            
            document.getElementById('discountValue').innerText = -res.discount 
            document.getElementById('totalAmount').innerText = res.amount

            const apply = document.getElementById('applyCoupons')
            const remove = document.getElementById('removeCoupons')

            remove.classList.remove('removeCoupon')
            console.log(apply)
            apply.classList.add('removeCoupon')

            document.getElementById('couponmsg').innerHTML = `Coupon Applied Successfully`
        } else {
            document.getElementById('couponmsg').innerHTML = `${res.msg}`
        }
    },
    error: function () {
        alert('Error: Unable to communicate with the server');
    }
});
}





function removeCoupon() {
            const coupon = document.getElementById('couponCode').value
            const amount = document.getElementById('price').innerText
            console.log(amount)
            console.log(coupon)
            console.log('removeCoupon() calleds')
            $.ajax({
                url: '/removeCoupon',
                method: 'post',
                data: {
                    coupon: coupon,
                    amount: amount
                },
                dataType: 'json',
                success: function (res) {
                    if (res.success) {
                        console.log(res,'in the remove coupon code ')
                        const applied = document.getElementById('applied')

                        console.log(applied)
                        const appliedamount = document.getElementById('discountValue')
                        applied.style.display = 'none'
                        appliedamount.style.display = 'none'
                        document.getElementById('totalAmount').innerText = res.amount

                        const apply = document.getElementById('applyCoupons')
                        const remove = document.getElementById('removeCoupons')

                        remove.classList.add('removeCoupon')
                        console.log(apply)
                        apply.classList.remove('removeCoupon')

                        document.getElementById('couponmsg').innerHTML = `Coupon Removed Successfully`

                    } else {
                        alert('something went wrong!!!!!')
                    }
                }

            })
        }


    </script>
    
    </body>
    
    </html>